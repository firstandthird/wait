/*!
 * wait - Javascript plugin to show an iOS style loading graphic.
 * v0.5.0
 * https://github.com/firstandthird/wait
 * copyright First + Third 2013
 * MIT License
*/
!function(a){a.declare("wait",{defaults:{title:"Loading...",preventClicks:!0,theme:"dark",onShow:a.noop,onHide:a.noop,pprogressSupport:!1,pprogressFill:"#000",overlayTemplate:'<div class="wait-overlay"></div>',modalTemplate:'<div class="wait"></div>',pprogressTemplate:'<div class="wait-pprogress"></div>'},show:function(a){this.setOptions(a),this.preventClicks&&this.el.addClass("wait-blur"),this.previousOverflow=this.el.css("overflow"),this.el.css("overflow","hidden"),this._createOverlay(),this._createModal(),this._bindEvents(),this.pprogress("start",!0),this.onShow.call(this),this.emit("show")},hide:function(){this._unbindEvents(),this.preventClicks&&this.el.removeClass("wait-blur"),this.el.css("overflow",this.previousOverflow),this._removeModal(),this._removeOverlay(),this.onHide.call(this),this.emit("hide")},setOptions:function(a){a=a||{},this.title=a.title||this.title,"undefined"!=typeof a.preventClicks&&(this.preventClicks=a.preventClicks),"undefined"!=typeof a.pprogressSupport&&(this.pprogressSupport=a.pprogressSupport),this.theme=a.theme||this.theme,this.onShow=a.onShow||this.onShow,this.onHide=a.onHide||this.onHide},setText:function(a){this.paragraph.text(a)},pprogress:function(){if(this.pprogressSupport){var a=Array.prototype.slice.call(arguments);a.length&&this.pprogressDiv.pprogress.apply(this.pprogressDiv,a)}},_createOverlay:function(){this.overlay=a(this.overlayTemplate).addClass("wait-"+this.theme).appendTo("body"),this._positionOverlay()},_removeOverlay:function(){this.overlay.remove()},_positionOverlay:function(){var a="0px",b="0px",c="100%",d="100%",e="fixed";if("body"!==this.el[0].nodeName.toLowerCase()){var f=this.el.offset();a=f.left+"px",b=f.top+"px",c=this.el.width()+"px",d=this.el.height()+"px",e="absolute"}this.overlay.css({width:c,height:d,left:a,top:b,position:e})},_createModal:function(){this.modal=a(this.modalTemplate).addClass("wait-"+this.theme).appendTo("body"),this.paragraph=a("<p></p>").text(this.title).appendTo(this.modal),this.pprogressSupport&&(this.pprogressDiv=a(this.pprogressTemplate).appendTo(this.modal),this.pprogressDiv.pprogress({fillColor:this.pprogressFill})),this._positionModal()},_removeModal:function(){this.modal.remove()},_positionModal:function(){var b,c,d="absolute";if("body"!==this.el[0].nodeName.toLowerCase()){var e=this.el.offset();c=(this.el.height()-this.modal.outerHeight())/2+e.top,b=(this.el.width()-this.modal.outerWidth())/2+e.left}else c=(a(window).height()-this.modal.outerHeight())/2+a(document).scrollTop(),b=(a(window).width()-this.modal.outerWidth())/2+a(document).scrollLeft();this.modal.css({left:b,top:c,position:d})},_bindEvents:function(){this.preventClicks&&this.overlay.on("click",this._preventClick),this.pprogressSupport&&this.pprogressDiv.on("complete",this.proxy(this.hide))},_unbindEvents:function(){this.preventClicks&&this.overlay.off(),this.pprogressSupport&&this.pprogressDiv.off()},_preventClick:function(){return!1}})}(jQuery);